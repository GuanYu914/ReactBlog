(this["webpackJsonpreact-router"]=this["webpackJsonpreact-router"]||[]).push([[0],{29:function(t,e,n){},30:function(t,e,n){},38:function(t,e,n){"use strict";n.r(e);var c,a,i,r,o,s=n(0),j=n.n(s),b=n(20),u=n.n(b),l=(n(29),n(7)),d=n(2),O=(n(30),Object(s.createContext)(null)),p=n(3),h=n(10),x=n(4),f="token",g=function(t){window.localStorage.setItem(f,t)},v=function(){return window.localStorage.getItem(f)},m=n(1),y=p.a.div(c||(c=Object(d.a)(["\n  height: 64px;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  border-bottom: 1px solid rgba(0, 0, 0, 0.2);\n  padding: 0px 32px;\n"]))),w=p.a.div(a||(a=Object(d.a)(["\n  font-size: 24px;\n  font-weight: bold;\n"]))),S=p.a.div(i||(i=Object(d.a)(["\n  display: flex;\n  align-items: center;\n"]))),k=p.a.div(r||(r=Object(d.a)(["\n  display: flex;\n  align-items: center;\n\n  "," {\n    margin-left: 32px;\n  }\n"])),S),C=Object(p.a)(h.b)(o||(o=Object(d.a)(["\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  height: 64px;\n  width: 128px;\n  font-weight: bold;\n  cursor: pointer;\n  color: black;\n  text-decoration: none;\n\n  ","\n"])),(function(t){return t.$active&&"\n    background: rgba(0, 0, 0, 0.2);\n  "}));var z,D,E,J,$=function(){var t=Object(x.g)(),e=Object(s.useContext)(O),n=e.user,c=e.setUser;return Object(m.jsxs)(y,{children:[Object(m.jsxs)(k,{children:[Object(m.jsx)(w,{children:"\u6211\u7684\u7b2c\u4e00\u500b\u90e8\u843d\u683c"}),Object(m.jsxs)(S,{children:[Object(m.jsx)(C,{to:"/",$active:"/"===t.pathname,children:"\u9996\u9801"}),n&&Object(m.jsx)(C,{to:"new-post",$active:"/new-post"===t.pathname,children:"\u767c\u4f48\u6587\u7ae0"})]})]}),Object(m.jsxs)("div",{children:[!n&&Object(m.jsx)(C,{to:"login",$active:"/login"===t.pathname,children:"\u767b\u5165"}),n&&Object(m.jsx)(C,{to:"/",onClick:function(){g(null),c(null)},children:"\u767b\u51fa"})]})]})},A="https://student-json-api.lidemy.me",B=function(){var t=v();return fetch("".concat(A,"/me"),{headers:{authorization:"Bearer ".concat(t)}}).then((function(t){return t.json()}))},I=p.a.div(z||(z=Object(d.a)([""]))),P=p.a.div(D||(D=Object(d.a)(["\n  border-bottom: 1px solid rgba(0, 0, 0, 0.2);\n  padding: 16px;\n  display: flex;\n  align-items: flex-end;\n  justify-content: space-between;\n"]))),U=Object(p.a)(h.b)(E||(E=Object(d.a)(["\n  font-size: 24px;\n  text-decoration: none;\n  color: black;\n"]))),q=p.a.div(J||(J=Object(d.a)(["\n  color: rgba(0, 0, 0, 0.8);\n"])));function L(t){var e=t.post;return Object(m.jsxs)(P,{children:[Object(m.jsx)(U,{to:"/posts/".concat(e.id),children:e.title}),Object(m.jsx)(q,{children:new Date(e.createdAt).toLocaleString()})]})}var N,T,_,H,M,F,G=function(){var t=Object(s.useState)([]),e=Object(l.a)(t,2),n=e[0],c=e[1];return Object(s.useEffect)((function(){fetch("".concat(A,"/posts?_sort=createdAt&_order=desc")).then((function(t){return t.json()})).then((function(t){return c(t)}))}),[]),Object(m.jsx)(I,{children:n.map((function(t){return Object(m.jsx)(L,{post:t},t.id)}))})},K=p.a.div(N||(N=Object(d.a)(["\n  color: red;\n"])));function Q(){var t=Object(s.useContext)(O).setUser,e=Object(s.useState)(""),n=Object(l.a)(e,2),c=n[0],a=n[1],i=Object(s.useState)(""),r=Object(l.a)(i,2),o=r[0],j=r[1],b=Object(s.useState)(""),u=Object(l.a)(b,2),d=u[0],p=u[1],h=Object(x.f)();return Object(m.jsxs)("form",{onSubmit:function(e){e.preventDefault(),p(""),function(t,e){return fetch("".concat(A,"/login"),{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({username:t,password:e})}).then((function(t){return t.json()}))}(c,o).then((function(e){if(!e.ok)return p(e.message);g(e.token),B().then((function(e){if(1!==e.ok)return g(null),p(e.toString());t(e.data),h.push("/")}))}))},children:[Object(m.jsxs)("div",{children:["username: ",Object(m.jsx)("input",{value:c,onChange:function(t){a(t.target.value)}})]}),Object(m.jsxs)("div",{children:["password:"," ",Object(m.jsx)("input",{type:"password",value:o,onChange:function(t){j(t.target.value)}})]}),Object(m.jsx)("input",{type:"submit",value:"\u767b\u5165"}),d&&Object(m.jsx)(K,{children:d})]})}var R=p.a.div(T||(T=Object(d.a)(["\n  margin-top: 40px;\n  padding: 10px 20px;\n"]))),V=p.a.div(_||(_=Object(d.a)(["\n  display: flex;\n  justify-content: flex-start;\n  align-items: flex-end;\n  margin-bottom: 50px;\n"]))),W=p.a.div(H||(H=Object(d.a)(["\n  font-size: 40px;\n  font-weight: bold;\n"]))),X=p.a.div(M||(M=Object(d.a)(["\n  margin-left: 30px;\n  font-size: 12px;\n"]))),Y=p.a.div(F||(F=Object(d.a)(["\n  font-size: 18px;\n"])));function Z(t){var e=t.post;return Object(m.jsxs)(R,{children:[Object(m.jsxs)(V,{children:[Object(m.jsx)(W,{children:e.title}),Object(m.jsx)(X,{children:new Date(e.createdAt).toLocaleString()})]}),Object(m.jsx)(Y,{children:e.body})]})}function tt(){var t=Object(x.h)().slug,e=Object(s.useState)([]),n=Object(l.a)(e,2),c=n[0],a=n[1];return Object(s.useEffect)((function(){var e;(e=t,fetch("".concat(A,"/posts?id=").concat(e)).then((function(t){return t.json()}))).then((function(t){a(t)}))}),[]),Object(m.jsx)("div",{children:c.map((function(t){return Object(m.jsx)(Z,{post:t},1)}))})}var et,nt,ct,at,it,rt=n(18),ot=p.a.div(et||(et=Object(d.a)([""]))),st=p.a.form(nt||(nt=Object(d.a)([""]))),jt=p.a.input(ct||(ct=Object(d.a)(["\n  display: block;\n  margin-top: 12px;\n"]))),bt=p.a.textarea(at||(at=Object(d.a)(["\n  display: block;\n  margin-top: 12px;\n"]))),ut=p.a.input(it||(it=Object(d.a)(["\n  margin-top: 16px;\n"])));var lt,dt=function(){var t=Object(rt.useState)(""),e=Object(l.a)(t,2),n=e[0],c=e[1],a=Object(rt.useState)(""),i=Object(l.a)(a,2),r=i[0],o=i[1],s=Object(x.f)();return Object(m.jsx)(ot,{children:Object(m.jsxs)(st,{onSubmit:function(t){t.preventDefault(),console.log(n,r),function(t,e){var n=v();return fetch("".concat(A,"/posts"),{method:"POST",headers:{"content-type":"application/json",authorization:"Bearer ".concat(n)},body:JSON.stringify({title:t,body:e})}).then((function(t){return t.json()}))}(n,r).then((function(t){t.id&&s.push("/")}))},children:[Object(m.jsx)("h2",{children:"\u767c\u4f48\u524d\u8acb\u5148\u4e09\u601d..."}),Object(m.jsx)(jt,{required:!0,value:n,onChange:function(t){c(t.target.value)},placeholder:"\u8acb\u8f38\u5165\u6a19\u984c\u540d\u7a31"}),Object(m.jsx)(bt,{required:!0,value:r,onChange:function(t){o(t.target.value)},rows:"10",cols:"30",placeholder:"\u8acb\u8f38\u5165\u5167\u5bb9..."}),Object(m.jsx)(ut,{type:"submit"})]})})},Ot=p.a.div(lt||(lt=Object(d.a)(["\n  padding-top: 64px;\n"])));var pt=function(){var t=Object(s.useState)(null),e=Object(l.a)(t,2),n=e[0],c=e[1];return Object(s.useEffect)((function(){"null"!==v()&&B().then((function(t){1===t.ok&&c(t.data)}))}),[]),Object(m.jsx)(O.Provider,{value:{user:n,setUser:c},children:Object(m.jsx)(Ot,{children:Object(m.jsxs)(h.a,{children:[Object(m.jsx)($,{children:"Header"}),Object(m.jsxs)(x.c,{children:[Object(m.jsx)(x.a,{exact:!0,path:"/",children:Object(m.jsx)(G,{})}),Object(m.jsx)(x.a,{path:"/login",children:Object(m.jsx)(Q,{})}),Object(m.jsx)(x.a,{path:"/posts/:slug",children:Object(m.jsx)(tt,{})}),Object(m.jsx)(x.a,{path:"/new-post",children:Object(m.jsx)(dt,{})})]})]})})})};u.a.render(Object(m.jsx)(j.a.StrictMode,{children:Object(m.jsx)(pt,{})}),document.getElementById("root"))}},[[38,1,2]]]);
//# sourceMappingURL=main.f3dab458.chunk.js.map